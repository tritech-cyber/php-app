Here are some updates to the exsisting code.
